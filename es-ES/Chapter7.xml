<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2016">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Proxy ICAP</title>
	<para>Este producto garantiza al usuario una monitorización completa de las interacciones que se están produciendo dentro de su red.</para>
	<para>Todo fichero incluido en una página web que se esté visualizando genera una notificación a Kafka; además, el fichero es enviado a S3 para su almacenamiento. De esta manera
	el usuario puede realizar un seguimiento en profundidad de todos aquellos ficheros que pasan por su red.</para>
	<warning>
		<title>Advertencia</title>
		<para>El usuario deberá configurar el servidor Proxy de su instalación añadiendo los parametros necesarios para que éste se enlace con el servidor Proxy ICAP proporcionado por redborder</para>
	</warning>
	<section>
		<title>Configuración del Proxy ICAP: tamaño de ficheros</title>
		<para>En la sección Tools->Malware Settings encontramos el apartado ICAP en el que es posible indicar el tamaño máximo de los ficheros (MB) que van a ser enviados a S3. Los ficheros que superen dicho tamaño
		no serán enviados para su almacenamiento en S3.</para>
		<mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="450" fileref="images/ch07_img001.png"/>
			</imageobject>
			<caption>
				<para>Tools->Malware Settings->ICAP</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>IP del servidor en el Proxy ICAP</title>
		<para>Para visualizar la IP del servidor Proxy cuyo tráfico está siendo procesado por el Proxy ICAP de redborder es necesario acudir a la sección Tools->Cluster Settings->Virtual IP Addresses. </para>
		<para>La IP que se indica en External IPs en el campo <literal>c-icap</literal> es la que corresponde a su servidor Proxy.</para>
		<mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="450" fileref="images/ch07_img002.png"/>
			</imageobject>
			<caption>
				<para>Tools->Cluster Settings->External IPs</para>
			</caption>
		</mediaobject>
	</section>
	<section>
		<title>Eventos Malware (Proxy ICAP)</title>
		<para>el usuario puede visualizar el tráfico que está siendo procesado por el Proxy ICAP en la sección Malware situada en el margen izquierdo del menú de cabecera.</para>
		<mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="450" fileref="images/ch05_img036.png"/>
			</imageobject>
			<caption>
				<para>Eventos Malware</para>
			</caption>
		</mediaobject>
		<warning>
			<title>Advertencia</title>
			<para>El tráfico SSH no es filtrado por el Proxy ICAP.</para>
		</warning>
		<para>Para visualizar los eventos producidos por los ficheros que pasan por la red el usuario puede seleccionar el atributo Hash mediante la opción <literal>+Add Tab.</literal> Es posible seleccionar
		tantos atributos como elementos quiera observar en el tráfico de su red. Es recomendable que se añada la pestaña <emphasis role="bold">para realizar un análisis en profundidad.</emphasis></para>
		<para>Esos atributos se añadirán a la vista y el usuario podrá realizar diferentes acciones sobre ellos.</para>
		<para>Una vez que hemos añadido a la vista los atributos deseados podremos visualizar un resumen con los eventos producidos por ellos. Al hacer clci sobre cualquiera de estos elementos se despliega un submenú desde el 
		cual se pueden realizar acciones de análisis y seguimiento de los objetos.</para>
		<mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="150" fileref="images/ch05_img036.png"/>
			</imageobject>
			<caption>
				<para>Submenú atributos en vista de eventos Malware</para>
			</caption>
		</mediaobject>
		<para><emphasis role="bold">Outliers</emphasis></para>
		<para>Activando esta opción se marcarán en la vista las anomalías de los eventos del atributo seleccionado. Esta acción es muy útil para aislar comportamientos anómalos dentro del flujo del tráfico.</para>
		<para>Para conseguir un resultado significativo esta consulta debe realizarse cuando el Manager contenga un histórico de datos de al menos un mes.</para>
		<para><emphasis role="bold">Filenames</emphasis></para>
		<para>Mediante esta opción el usuario obtiene el nombre de un fichero a partir de un hash. Esto simplifica la identificación de un fichero concreto que haya aparecido bajo el mismo nombre.</para>	
		<para><emphasis role="bold">Analysis</emphasis></para>
		<para>Al seleccionar la opción <literal>Analysis</literal> el usuario visualiza un completo resumen sobre el estado del fichero.</para>
		<para>En la pantalla de Analysis se muestra la siguiente información:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para><emphasis role="bold">Status</emphasis></para>
				<para>En este apartado se muestra el progreso del análisis del fichero y la información correspondiente a los servicios externos de reputación.</para>
				<para>Es posible descargar el fichero que se está analizando mediante la opción <literal>Download File.</literal></para>
			</listitem>
			<listitem>
				<para><emphasis role="bold">Loaders</emphasis></para>
				<para>En este apartado se muestra con mayor grado de detalle el proceso y resultado del análisis realizado por los diferentes cargadores o servicios de reputación.</para>
				<para>Es posible realizar la descarga del histórico del fichero en formato JSON.</para>
			</listitem>
		</itemizedlist>
		<mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="450" fileref="images/ch07_img003.png"/>
			</imageobject>
			<caption>
				<para>Analysis</para>
			</caption>
		</mediaobject>
		<para><emphasis role="bold">Evolution</emphasis></para>
		<para>Show Evolution muestra la evolución temporal de los diferentes eventos recogidos por cada uno de los sensores que se encuentran registrados en el Manager. </para>
		<para>En la parte superior de la pantalla encontramos una representación gráfica de esta evolución sobre una línea de tiempo. Dependiendo del volumen de los círculos se habrán registrado
		 mayor o menor número de eventos para un periodo de tiempo determinado.</para>
		 <para>En la parte inferior se ofrece un resumen detallado de cada uno de los eventos por sensor especificando el score asignado para el objeto que se está analizando, el sensor, SRC Address
		 DST Address, el email emisor, los emails receptores y el número de eventos generados por ese objeto (en la imagen se trata de eventos registrados para una URL). </para>
		 <mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="450" fileref="images/ch07_img004.png"/>
			</imageobject>
			<caption>
				<para>Show evolution</para>
			</caption>
		</mediaobject>	 
		<para><emphasis role="bold">Propagation</emphasis></para>
		<para>Al seleccionar la opción <literal>Show Propagation</literal> accedemos a una interfaz en la que se nos muestra de manera gráfica la propagación
		de ese objeto (en la imagen URL) a través de las IPs o Emails de nuestra organización.</para>
		<para>Haciendo clic en alguno de los nodos que se muestran (IPs/emails de origen y de destino) se visualiza en la parte inferior un resumen de todos los eventos generados
		 por ese objeto en el periodo de tiempo seleccionado. </para>
		<mediaobject>
			<imageobject>
				<imagedata scale="1" align="center" width="450" fileref="images/ch07_img005.png"/>
			</imageobject>
			<caption>
				<para>Show Propagation</para>
			</caption>
		</mediaobject>
	</section>
</chapter>
