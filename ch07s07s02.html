<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>7.7.2. Definición de las reglas IOC</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css" /><link rel="stylesheet" media="print" href="Common_Content/css/print.css" type="text/css" /><meta name="generator" content="publican 3.2.1" /><meta name="package" content="redBorder_Malware-Guia_de_instalacion-1.0-es-ES-0.1-0" /><link rel="home" href="index.html" title="Guía de instalación" /><link rel="up" href="ch07s07.html" title="7.7. Indicadores de compromiso: IOCs" /><link rel="prev" href="ch07s07.html" title="7.7. Indicadores de compromiso: IOCs" /><link rel="next" href="ch07s07s02s02.html" title="7.7.2.2. net.redborder.ioc.rules.memory" /></head><body><p id="title"><a class="left" href="https://fedorahosted.org/publican"><img alt="Product Site" src="Common_Content/images//image_left.png" /></a><a class="right" href="https://fedorahosted.org/publican"><img alt="Documentation Site" src="Common_Content/images//image_right.png" /></a></p><ul class="docnav top"><li class="previous"><a accesskey="p" href="ch07s07.html"><strong>Anterior</strong></a></li><li class="home">Guía de instalación</li><li class="next"><a accesskey="n" href="ch07s07s02s02.html"><strong>Siguiente</strong></a></li></ul><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm47793246507168"></a>7.7.2. Definición de las reglas IOC</h3></div></div></div><div class="para">
				La adición y definición de las reglas que se integran en los indicadores de compromiso se deben definir en el archivo <code class="literal">/root/chef/cookbooks/redborder-manager/templates/default/samza-ioc.properties.erb</code>.
			</div><div class="para">
				Existen un número infinito de reglas que se pueden determinar para un IOC ya que dependen siempre de las necesidades de los usuarios.
			</div><div class="para">
				Los IOC (<code class="literal">net.redborder.ioc</code>) pueden estar definidos a través de dos tipos de reglas:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="bold bold"><strong>Reglas de procesos:</strong></span> net.redborder.ioc.rules.memory
					</div></li><li class="listitem"><div class="para">
						<span class="bold bold"><strong>Reglas generales: </strong></span>net.redborder.ioc.rules
					</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Nota</strong></p></div><div class="admonition"><div class="para">
					Todas las reglas, ya sean de procesos o generales, presentan algunos campos comunes:
				</div><div class="para">
					<span class="bold bold"><strong>-uuid=</strong></span> identificador de la regla; compuesto por una cadena alfanumérica de caracteres.
				</div><div class="para">
					<span class="bold bold"><strong>-Type=</strong></span> descripción del tipo de regla.
				</div><div class="para">
					<span class="bold bold"><strong>-Baserule=</strong></span> regla en sí misma.
				</div><div class="para">
					<span class="bold bold"><strong>-EnabledConditions/DisabledConditions=</strong></span> incluyen los criterios de activación o desactivación de una regla.
				</div></div></div><div class="para">
				Los campos que definen la activación o desactivación de una regla <code class="literal">EnabledConditions</code>/<code class="literal">DisabledConditions</code> deben estar compuestos por alguno de los criterios siguientes:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="literal">AND:</code> unión de reglas con el "y" lógico.
					</div></li><li class="listitem"><div class="para">
						<code class="literal">OR:</code> unión de reglas con el "o" lógico.
					</div></li><li class="listitem"><div class="para">
						<code class="literal">CONTAINS:</code> describe el elemento que debe estar contenido en uno de los campos del reporte del Agente de carga.
					</div></li><li class="listitem"><div class="para">
						<code class="literal">FIELD:</code> coincidencia exacta.
					</div></li></ul></div><div class="para">
				A continuación se describe la sintaxis de cada una de las reglas que pueden formar un IOC.
			</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm47793246484560"></a>7.7.2.1. net.redborder.ioc</h4></div></div></div><div class="para">
					Esta línea contiene la referencia (uuid) del IOC definido y el uuid de las reglas que contiene dicho IOC (y que han sido definidas en la línea "rules" y "memory"). Su sintaxis es como sigue:
				</div><div class="para">
					
<pre class="screen">net.redborder.ioc: [{"uuid":"uuidIOC", "rules":[“uuid1”,”uuid2”]}]</pre>
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							uuidIOC= identificador del IOC; cadena alfanumérica de caracteres
						</div></li><li class="listitem"><div class="para">
							rules= uuid de las reglas definidas por el usuario
						</div></li></ul></div><div class="warning"><div class="admonition_header"><p><strong>Advertencia</strong></p></div><div class="admonition"><div class="para">
						Se recomienda la asignación de uuid diferentes tanto para las reglas como para los IOCs para evitar posibles errores en la activación/desactivación de los mismos.
					</div></div></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="ch07s07.html"><strong>Anterior</strong>7.7. Indicadores de compromiso: IOCs</a></li><li class="up"><a accesskey="u" href="#"><strong>Subir</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Inicio</strong></a></li><li class="next"><a accesskey="n" href="ch07s07s02s02.html"><strong>Siguiente</strong>7.7.2.2. net.redborder.ioc.rules.memory</a></li></ul></body></html>